---
x-definitions:
  ApiGatewayIntegration:
    type: object
    x-amazon-apigateway-integration: &ApiGatewayIntegration
      type: aws_proxy
      httpMethod: POST
      responses:
        default:
          statusCode: "200"
      passthroughBehavior: when_no_match
      contentHandling: CONVERT_TO_TEXT

  RequestHeaders:
    type: object
    headers: &RequestHeaders
      parameters:
        - in: header
          name: version
          schema:
            $ref: "#/components/schemas/Version"
        - in: header
          name: x-request-id
          schema:
            $ref: "#/components/schemas/RequestId"
        - in: header
          name: x-correlation-id
          schema:
            $ref: "#/components/schemas/CorrelationId"

paths:
  /_status:
    get:
      summary: _status endpoint for APIGEE integration
      operationId: status
      responses:
        "200":
          description: API is operational
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
                    enum: ["OK"]
      <<: *RequestHeaders
      x-amazon-apigateway-integration:
        <<: *ApiGatewayIntegration
        uri: ${method_status}

  /product-team:
    post:
      summary: Create a new Product Team
      requestBody:
        $ref: "#/components/requestBodies/ProductTeam"
      responses:
        "201":
          $ref: "#/components/responses/CreatedSuccessfully"
        "400":
          $ref: "#/components/responses/BadRequest"
      <<: *RequestHeaders
      x-amazon-apigateway-integration:
        <<: *ApiGatewayIntegration
        uri: ${method_createProductTeam}

  /product-team/{id}:
    get:
      summary: Get a Product Team by ID
      parameters:
        - $ref: "#/components/parameters/ProductTeamId"
      responses:
        "200":
          $ref: "#/components/responses/ProductTeam"
        "404":
          $ref: "#/components/responses/NotFound"
      x-amazon-apigateway-integration:
        <<: *ApiGatewayIntegration
        uri: ${method_readProductTeam}
